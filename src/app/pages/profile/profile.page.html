<ion-content class="ion-padding">

  <!-- HEADER -->
  <div class="header-container">
    <p class="custom-title">CONFIGURACIONES</p>
  </div>

  <!-- BOTÓN LISTO -->
  <ion-item class="btnListo" lines="none">
    <ion-buttons slot="end">
      <ion-button (click)="onListoClick()">Listo</ion-button>
    </ion-buttons>
  </ion-item>

  <!-- SEGMENT -->
  <ion-segment mode="ios" [(ngModel)]="mode" value="editar" class="profile-segment">
    <ion-segment-button value="editar">
      <ion-label>EDITAR</ion-label>
    </ion-segment-button>
    <ion-segment-button value="preview">
      <ion-label>VISTA PREVIA</ion-label>
    </ion-segment-button>
  </ion-segment>

  <!-- ========================= -->
  <!-- EDITAR -->
  <!-- ========================= -->
  <ng-container *ngIf="mode === 'editar'">

    <!-- PERFIL PÚBLICO -->
    <ion-item button (click)="toggleSection('public')" lines="none" class="buttstyle">
      <ion-label>Perfil público</ion-label>
      <ion-icon [name]="sections.public ? 'chevron-up-outline' : 'chevron-down-outline'" slot="end"></ion-icon>
    </ion-item>

    <ng-container *ngIf="sections.public">
      <div class="section-content">

        <!-- Descripción -->
        <ion-item class="campoTxt" lines="none">
          <ion-textarea
            [(ngModel)]="profile.description"
            autoGrow="true"
            placeholder="Explica algo sobre ti">
          </ion-textarea>
        </ion-item>

        <!-- Género -->
        <ion-item class="campoGenero" lines="none">
          <ion-select
            [(ngModel)]="profile.gender"
            interface="action-sheet"
            placeholder="Seleccionar género">
            <ion-select-option value="masculino">Masculino</ion-select-option>
            <ion-select-option value="femenino">Femenino</ion-select-option>
            <ion-select-option value="otro">Otro</ion-select-option>
          </ion-select>
          <div class="line"></div>
        </ion-item>

        <!-- Edad -->
        <ion-item class="campoEdad" lines="none">
          <ion-select
            [(ngModel)]="profile.age"
            interface="popover"
            placeholder="00">
            <ion-select-option *ngFor="let age of ageOptions" [value]="age.value">
              {{ age.display }}
            </ion-select-option>
          </ion-select>
        </ion-item>

        <!-- Fotos -->
        <ion-item lines="none" class="fotos none">
          <span class="dot-text">Fotos</span>
          <div class="dot-fill"></div>
          <ion-button fill="clear" size="small" (click)="onPlusClick()">
            <img class="imgAdd" src="assets/iconsYimgs/plus.png" alt="Añadir foto">
          </ion-button>
        </ion-item>

      </div>
    </ng-container>

    <!-- PREFERENCIAS PRIVADAS -->
    <ion-item button (click)="toggleSection('private')" lines="none" class="buttstyle">
      <ion-label>Preferencias privadas</ion-label>
      <ion-icon
        [name]="sections.private ? 'chevron-up-outline' : 'chevron-down-outline'"
        slot="end">
      </ion-icon>
    </ion-item>

    <ng-container *ngIf="sections.private">
      <div class="section-content">

        <!-- Ubicación -->
        <ion-label class="field-label">Ubicación</ion-label>
        <ion-item class="campoGenero" lines="none">
          <ion-select
            [(ngModel)]="privateProfile.location"
            interface="action-sheet"
            placeholder="Selecciona ciudad">
            <ion-select-option value="Madrid">Madrid</ion-select-option>
            <ion-select-option value="Barcelona">Barcelona</ion-select-option>
            <ion-select-option value="Valencia">Valencia</ion-select-option>
            <ion-select-option value="Sevilla">Sevilla</ion-select-option>
            <ion-select-option value="Zaragoza">Zaragoza</ion-select-option>
            <ion-select-option value="Málaga">Málaga</ion-select-option>
            <ion-select-option value="Murcia">Murcia</ion-select-option>
            <ion-select-option value="Palma">Palma</ion-select-option>
            <ion-select-option value="Bilbao">Bilbao</ion-select-option>
            <ion-select-option value="Alicante">Alicante</ion-select-option>
          </ion-select>
        </ion-item>

        <!-- Género buscado -->
        <ion-label class="field-label">Género buscado</ion-label>
        <ion-item class="campoGenero" lines="none">
          <ion-select
            [(ngModel)]="privateProfile.lookingGender"
            interface="action-sheet"
            placeholder="Seleccionar género">
            <ion-select-option value="masculino">Masculino</ion-select-option>
            <ion-select-option value="femenino">Femenino</ion-select-option>
            <ion-select-option value="otro">Otro</ion-select-option>
          </ion-select>
          <div class="line"></div>
        </ion-item>

        <!-- Rango de edad -->
        <ion-label class="field-label">Rango de edad</ion-label>

        <ion-item class="rangoEdad" lines="none">
          <ion-select
            [(ngModel)]="privateProfile.ageMin"
            interface="popover"
            placeholder="Edad mínima">
            <ion-select-option
              *ngFor="let age of ageOptions"
              [value]="age.value">
              {{ age.display }}
            </ion-select-option>
          </ion-select>
        </ion-item>

        <ion-item class="rangoEdad" lines="none">
          <ion-select
            [(ngModel)]="privateProfile.ageMax"
            interface="popover"
            placeholder="Edad máxima">
            <ion-select-option
              *ngFor="let age of ageOptions"
              [value]="age.value">
              {{ age.display }}
            </ion-select-option>
          </ion-select>
        </ion-item>

      </div>
    </ng-container>


  </ng-container>

  <!-- ========================= -->
  <!-- VISTA PREVIA -->
  <!-- ========================= -->
  <ng-container *ngIf="mode === 'preview'">
    <div class="preview-content">

      <div class="preview-card">
        <!-- Foto -->
        <img
          *ngIf="profile.photos && profile.photos.length > 0"
          [src]="profile.photos[0]"
          class="preview-image"
          alt="Foto de perfil" />

        <!-- Descripción -->
        <div class="overlay-text">
          {{ profile.description || 'Sin descripción' }}
        </div>

        <!-- Edad / Género -->
        <div class="overlay-data">
          <span>{{ profile.age ?? '--' }} años</span>
          <span>{{ profile.gender || 'Sin especificar' }}</span>
        </div>
      </div>

    </div>
  </ng-container>

</ion-content>
